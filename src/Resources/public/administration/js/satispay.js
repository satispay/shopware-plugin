!function(t){var e={};function n(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(a,i,function(e){return t[e]}.bind(null,i));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=(window.__sw__.assetPath + '/bundles/satispay/'),n(n.s="wgYY")}({DpYa:function(t){t.exports=JSON.parse('{"satispay-payments":{"general":{"mainMenuItemGeneral":"Satispay","descriptionTextModule":"Spare Zeit und Geld, indem du Zahlungen von deinen Kunden mit Satispay akzeptierst. Kostenlos, einfach, sicher! #doitsmart"},"paymentDetails":{"title":"Zahlungsdetails","buttons":{"label":{"refund":"Eine Rückerstattung machen"}},"status":{"heading":"Zahlung"},"errorPage":{"title":"Fehler","subline":"Beim Abrufen der Zahlungsdetails ist ein Fehler aufgetreten."},"description":{"status":"Status","amount":"Betrag","currency":"Währung","type":"Art","flow":"Fluss"},"modal":{"refund":{"title":"Rückerstattung","amount":{"label":"Betrag","helpText":"Zu erstattender Betrag für die aktuelle Bestellung.","helpTextEmpty":"Leer lassen, um den Gesamtbetrag zu erstatten.","helpTextDecimals":"Die Dezimalstellen müssen mit dem Punkt dividiert werden."},"confirmButton":"Eine Rückerstattung machen"},"notification":{"success":"Rückerstattung ausgeführt","error":"Es ist ein Fehler aufgetreten. Bitte versuche es erneut oder kontaktiere deinen Support."}}}},"satispay-config":{"activateButton":"Aktivieren","notification":{"success":"Aktivierung abgeschlossen","error":"Es ist ein Fehler aufgetreten. Bitte versuche es erneut oder kontaktiere deinen Support."}}}')},hDWn:function(t){t.exports=JSON.parse('{"satispay-payments":{"general":{"mainMenuItemGeneral":"Satispay","descriptionTextModule":"Save time and money by accepting payments from your customers with Satispay. Free, simple, secure! #doitsmart"},"paymentDetails":{"title":"Payment details","buttons":{"label":{"refund":"Make a refund"}},"status":{"heading":"Payment"},"errorPage":{"title":"Error","subline":"An error occurred while retrieving the payment details."},"description":{"status":"Status","amount":"Amount","currency":"Currency","type":"Type","flow":"Flow"},"modal":{"refund":{"title":"Refund","amount":{"label":"Amount","helpText":"Amount to refund for the current order.","helpTextEmpty":"Leave empty to refund the total amount.","helpTextDecimals":"Decimals must be divided with a dot."},"confirmButton":"Perform refund"},"notification":{"success":"Refund approved","error":"An error occurred. Please retry or contact your support."}}}},"satispay-config":{"activateButton":"Activate","notification":{"success":"Activation processed","error":"An error occurred. Please retry or contact your support."}}}')},qRKd:function(t){t.exports=JSON.parse('{"satispay-payments":{"general":{"mainMenuItemGeneral":"Satispay","descriptionTextModule":"Risparmia tempo e denaro ricevendo pagamenti dai tuoi clienti con Satispay. Gratuita, semplice, sicura. #doitsmart"},"paymentDetails":{"title":"Dettagli pagamento","buttons":{"label":{"refund":"Effettua un rimborso"}},"status":{"heading":"Pagamento"},"errorPage":{"title":"Errore","subline":"Si è verificato un errore durante il recupero dei dettagli di pagamento."},"description":{"status":"Stato","amount":"Importo","currency":"Valuta","type":"Tipologia","flow":"Flusso"},"modal":{"refund":{"title":"Rimborso","amount":{"label":"Importo","helpText":"Importo da rimborsare per l\'ordine corrente.","helpTextEmpty":"Lasciare vuoto per rimborsare l\'intero importo.","helpTextDecimals":"I decimali vanno divisi con il punto."},"confirmButton":"Effettua rimborso"},"notification":{"success":"Rimborso eseguito","error":"Si è verificato un errore. Riprova o contatta il supporto."}}}},"satispay-config":{"activateButton":"Attiva","notification":{"success":"Attivazione effettuata","error":"Si è verificato un errore. Riprova o contatta il supporto."}}}')},wgYY:function(t,e,n){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,o=void 0,o=function(t,e){if("object"!==a(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===a(o)?o:String(o)),i)}var r,o}function o(t,e){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=l(t);if(e){var i=l(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return c(this,n)}}function c(t,e){if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.r(e);var u=Shopware.Classes.ApiService,p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o(t,e)}(l,t);var e,n,a,c=s(l);function l(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"satispay";return i(this,l),c.call(this,t,e,n)}return e=l,(n=[{key:"activate",value:function(){var t="_action/".concat(this.getApiBasePath(),"/activate");return this.httpClient.get(t,{headers:this.getBasicHeaders()}).then((function(t){return u.handleResponse(t)}))}}])&&r(e.prototype,n),a&&r(e,a),Object.defineProperty(e,"prototype",{writable:!1}),l}(u);function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,(i=a.key,r=void 0,r=function(t,e){if("object"!==d(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==d(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===d(r)?r:String(r)),a)}var i,r}function f(t,e){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return b(this,n)}}function b(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v=Shopware.Classes.ApiService,w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(r,t);var e,n,a,i=h(r);function r(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"satispay";return y(this,r),i.call(this,t,e,n)}return e=r,(n=[{key:"getPaymentDetails",value:function(t,e){var n="_action/".concat(this.getApiBasePath(),"/payment-details/").concat(t,"/").concat(e);return this.httpClient.get(n,{headers:this.getBasicHeaders()}).then((function(t){return v.handleResponse(t)}))}},{key:"refundPayment",value:function(t,e,n){var a="_action/".concat(this.getApiBasePath(),"/refund-payment/").concat(t,"/").concat(e);return this.httpClient.post(a,{refundAmount:n},{headers:this.getBasicHeaders()}).then((function(t){return v.handleResponse(t)}))}}])&&m(e.prototype,n),a&&m(e,a),Object.defineProperty(e,"prototype",{writable:!1}),r}(v);Shopware.Application.addServiceProvider("SatispayConfigApiService",(function(t){var e=Shopware.Application.getContainer("init");return new p(e.httpClient,t.loginService)})),Shopware.Application.addServiceProvider("SatispayPaymentService",(function(t){var e=Shopware.Application.getContainer("init");return new w(e.httpClient,t.loginService)}));var S=Shopware,_=S.Component,P=S.Mixin;_.override("sw-plugin-config",{template:'{% block sw_plugin_config_actions_save %}\n     {%  parent %}\n     {% block satispay_plugin_config_actions_activate %}\n     {% endblock %}\n{% endblock %}\n{% block sw_plugin_config_content %}\n {%  parent %}\n    <sw-loader v-if="isLoading"></sw-loader>\n{% endblock %}\n\n',inject:["SatispayConfigApiService"],mixins:[P.getByName("notification")],data:function(){return{isLoading:!1}},methods:{handleErrorOnApi:function(t){try{var e=void 0!==t.response.data.error?t.response.data.error:this.$tc("satispay-config.notification.error");this.createNotificationError({title:this.$tc("global.default.error"),message:e,autoClose:!1})}finally{this.isLoading=!1}},handleApiResponse:function(){try{this.createNotificationSuccess({title:this.$tc("global.default.success"),message:this.$tc("satispay-config.notification.success")})}finally{this.isLoading=!1,window.location.reload()}},onActivateClickedButton:function(){this.isLoading=!0,this.SatispayConfigApiService.activate().then(this.handleApiResponse).catch(this.handleErrorOnApi)}}});var A=Shopware,D=A.Component,O=A.Mixin,k=A.Context,x=Shopware.Data.Criteria;D.register("satispay-payment-detail",{template:'{% block satispay_payment_detail %}\n    <div class="satispay-payment-detail">\n        <div v-if="!isLoading && showPaymentDetails">\n            <sw-card :title="$tc(\'satispay-payments.paymentDetails.title\')">\n                <template #grid>\n\n                    {% block satispay_payment_actions_section %}\n                        <sw-card-section secondary slim>\n                            <satispay-payment-actions :order="order" :paymentResource="paymentTransactionData">\n                            </satispay-payment-actions>\n                        </sw-card-section>\n                    {% endblock %}\n\n                    <sw-card-section divider="top">\n                        <sw-container columns="1fr"\n                                      gap="0px 30px">\n                            <h3>\n                                  {{ $tc(\'satispay-payments.paymentDetails.status.heading\') }}\n                            </h3>\n\n                            {% block satispay_payment_detail %}\n                                <sw-description-list>\n                                    <dt>{{ $tc(\'satispay-payments.paymentDetails.description.status\') }}</dt>\n                                    <dd>{{ status }}</dd>\n                                    <dt>{{ $tc(\'satispay-payments.paymentDetails.description.amount\') }}</dt>\n                                    <dd>{{ amount }}</dd>\n                                    <dt>{{ $tc(\'satispay-payments.paymentDetails.description.currency\') }}</dt>\n                                    <dd>{{ currency }}</dd>\n                                    <dt>{{ $tc(\'satispay-payments.paymentDetails.description.flow\') }}</dt>\n                                    <dd>{{ flow }}</dd>\n                                    <dt>{{ $tc(\'satispay-payments.paymentDetails.description.type\') }}</dt>\n                                    <dd>{{ type }}</dd>\n                                </sw-description-list>\n                            {% endblock %}\n                        </sw-container>\n                    </sw-card-section>\n                </template>\n            </sw-card>\n\n        </div>\n\n        <div v-if="showError">\n            <sw-empty-state\n                :title="$tc(\'satispay-payments.paymentDetails.errorPage.title\')"\n                :subline="$tc(\'satispay-payments.paymentDetails.errorPage.subline\')"\n                icon="default-shopping-paper-bag"\n                color="#A092F0">\n            </sw-empty-state>\n        </div>\n\n        <sw-loader v-if="isLoading"></sw-loader>\n    </div>\n{% endblock %}\n',inject:["SatispayPaymentService","repositoryFactory"],mixins:[O.getByName("notification")],data:function(){return{isLoading:!0,showPaymentDetails:!1,order:null,satispayTransactionId:null,paymentTransactionData:null,currency:null,status:null,flow:null,type:null}},computed:{showError:function(){return!1===this.isLoading&&!1===this.showPaymentDetails},amount:function(){return this.paymentTransactionData?this.paymentTransactionData.amount_unit/100:0}},created:function(){this.createdComponent()},methods:{handleErrorOnApi:function(t){try{this.createNotificationError({title:this.$tc("satispay-payments.paymentDetails.errorPage.title"),message:t.response.data.errors[0].detail,autoClose:!1})}finally{this.isLoading=!1,this.showPaymentDetails=!1}},createdComponent:function(){var t=this,e=this.$route.params.id,n=this.repositoryFactory.create("order"),a=new x(1,1);a.getAssociation("transactions").addSorting(x.sort("createdAt")),n.get(e,k.api,a).then((function(e){t.order=e;var n=e.transactions.length-1;if(null===e.transactions[n].customFields||void 0===e.transactions[n].customFields.satispay_payment_id)return t.isLoading=!1,void(t.showPaymentDetails=!1);var a=e.transactions[n].customFields.satispay_payment_id;t.showPaymentDetails=!0,t.SatispayPaymentService.getPaymentDetails(t.order.id,a).then((function(e){t.paymentTransactionData=e,t.status=t.paymentTransactionData.status,t.currency=t.paymentTransactionData.currency,t.flow=t.paymentTransactionData.flow,t.type=t.paymentTransactionData.type,t.isLoading=!1})).catch(t.handleErrorOnApi)})).catch(this.handleErrorOnApi)}}});var R=Shopware,T=R.Component,j=R.Mixin;T.register("satispay-payment-action-refund",{template:'{% block satispay_payment_actions_modal_refund %}\n\n    <sw-modal\n        variant="small"\n        :title="$tc(`satispay-payments.paymentDetails.modal.refund.title`)"\n        @modal-close="$emit(\'modal-close\')">\n        <sw-number-field\n            :max="refundableAmount"\n            :min="0"\n            v-model="refundAmount"\n            :label="$tc(\'satispay-payments.paymentDetails.modal.refund.amount.label\')"\n            :helpText="$tc(\'satispay-payments.paymentDetails.modal.refund.amount.helpText\')">\n            <template #suffix>\n                {{ paymentResource.currency }}\n            </template>\n        </sw-number-field>\n        <span style="font-size: 10px;">\n            {{ $tc(\'satispay-payments.paymentDetails.modal.refund.amount.helpTextEmpty\') }}\n            <br />\n            {{ $tc(\'satispay-payments.paymentDetails.modal.refund.amount.helpTextDecimals\') }}\n        </span>\n        <template #modal-footer>\n            <sw-button variant="primary"\n                       @click="refund">\n                {{ $tc(\'satispay-payments.paymentDetails.modal.refund.confirmButton\') }}\n            </sw-button>\n        </template>\n\n    </sw-modal>\n{% endblock %}\n',inject:["SatispayPaymentService"],mixins:[j.getByName("notification")],props:{paymentResource:{type:Object,required:!0},order:{type:Object,required:!0}},data:function(){return{refundableAmount:0,refundAmount:0,isLoading:!1}},created:function(){this.paymentResource&&(this.refundableAmount=this.paymentResource.amount_unit/100)},methods:{handleErrorOnApi:function(t){try{var e=void 0!==t.response.data.error?t.response.data.error:this.$tc("satispay-payments.paymentDetails.modal.notification.error");this.createNotificationError({title:this.$tc("satispay-payments.paymentDetails.errorPage.title"),message:e,autoClose:!1})}finally{this.isLoading=!1,this.showPaymentDetails=!1,this.$emit("modal-close")}},handleApiResponse:function(){try{this.createNotificationSuccess({title:this.$tc("global.default.success"),message:this.$tc("satispay-payments.paymentDetails.modal.notification.success")})}finally{this.isLoading=!1,this.showPaymentDetails=!0,this.$emit("modal-close")}},refund:function(){this.isLoading=!0;var t=this.order.transactions.length-1,e=this.order.transactions[t].customFields.satispay_payment_id,n=0===this.refundAmount?this.refundableAmount:this.refundAmount;this.SatispayPaymentService.refundPayment(this.order.id,e,n).then(this.handleApiResponse).catch(this.handleErrorOnApi)}}}),Shopware.Component.register("satispay-payment-actions",{template:'{% block satispay_payment_actions %}\n<div>\n    <div class="satispay-payment-actions__button-container">\n        <div class="satispay-payment-actions__authorize-button-group">\n\n            {% block satispay_payment_actions_refund %}\n                <sw-button variant="primary"\n                           size="small"\n                           :disabled="notRefundable"\n                           @click="showModal = true">\n                    {{ $tc(\'satispay-payments.paymentDetails.buttons.label.refund\') }}\n                </sw-button>\n            {% endblock %}\n\n        </div>\n\n        {% block satispay_payment_actions_modal %}\n\n            {% block satispay_payment_actions_modal_refund %}\n                <satispay-payment-action-refund\n                    v-if="showModal"\n                    @modal-close="showModal=false"\n                    :order="order" :paymentResource="paymentResource">\n                </satispay-payment-action-refund>\n            {% endblock %}\n\n        {% endblock %}\n    </div>\n</div>\n{% endblock %}\n',data:function(){return{showModal:!1}},props:{paymentResource:{type:Object,required:!0},order:{type:Object,required:!0}},computed:{notRefundable:function(){var t=this.order.transactions.length-1,e=this.order.transactions[t].stateMachineState.technicalName,n=["paid","paid_partially","refunded"].indexOf(e)>-1;return this.paymentResource.amount_unit<=0||"ACCEPTED"!=this.paymentResource.status||!n}}});var E=n("hDWn"),C=n("DpYa"),$=n("qRKd");Shopware.Module.register("satispay-payment",{type:"plugin",name:"SatispayPayments",title:"satispay-payments.general.mainMenuItemGeneral",description:"satispay-payments.general.descriptionTextModule",version:"1.0.0",targetVersion:"1.0.0",color:"#333",icon:"default-action-settings",snippets:{"en-GB":E,"de-DE":C,"it-IT":$},routeMiddleware:function(t,e){"sw.order.detail"===e.name&&e.children.push({component:"satispay-payment-detail",name:"satispay.payment.detail",isChildren:!0,path:"/sw/order/satispay/detail/:id",meta:{parentPath:"sw.order.index"}}),t(e)}});var B=Shopware,M=B.Component,L=B.Mixin;M.register("satispay-config-check-button",{template:'<template>\n    <sw-button class="sw-plugin-config__activate-action"\n            @click="onActivateClickedButton"\n    >{{ $tc(\'satispay-config.activateButton\') }}</sw-button>\n</template>\n\n',inject:["SatispayConfigApiService"],mixins:[L.getByName("notification")],data:function(){return{isLoading:!1}},methods:{handleErrorOnApi:function(t){try{var e=void 0!==t.response.data.error?t.response.data.error:this.$tc("satispay-config.notification.error");this.createNotificationError({title:this.$tc("global.default.error"),message:e,autoClose:!1})}finally{this.isLoading=!1}},handleApiResponse:function(){try{this.createNotificationSuccess({title:this.$tc("global.default.success"),message:this.$tc("satispay-config.notification.success")})}finally{this.isLoading=!1,window.location.reload()}},onActivateClickedButton:function(){this.isLoading=!0,this.SatispayConfigApiService.activate().then(this.handleApiResponse).catch(this.handleErrorOnApi)}}});var F=Shopware,N=F.Component,I=F.Context,z=Shopware.Data.Criteria;N.override("sw-order-detail",{template:"{% block sw_order_detail_content_tabs_general %}\n    {% parent %}\n\n    <sw-tabs-item\n        v-if=\"isSatispayPayment\"\n        :route=\"{ name: 'satispay.payment.detail', params: { id: $route.params.id } }\"\n        :title=\"$tc('satispay-payments.order-detail.tabTitle')\">\n        {{ $tc('satispay-payments.order-detail.tabTitle') }}\n    </sw-tabs-item>\n{% endblock %}\n",inject:["repositoryFactory"],data:function(){return{isSatispayPayment:!1}},created:function(){this.initializeSatispay()},methods:{initializeSatispay:function(){var t=this,e=this.orderId,n=this.repositoryFactory.create("order"),a=new z(1,1);a.getAssociation("transactions").addSorting(z.sort("createdAt")),n.get(e,I.api,a).then((function(e){var n=e.transactions.length-1;null!==e.transactions[n].customFields&&void 0!==e.transactions[n].customFields.satispay_payment_id?t.isSatispayPayment=!0:t.isSatispayPayment=!1}))}}})}});